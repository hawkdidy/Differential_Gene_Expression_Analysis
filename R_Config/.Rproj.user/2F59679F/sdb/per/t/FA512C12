{
    "contents" : "#This script will remove genes with low variance as well as the affy control probes\n#Then it will fit a linear models to determine the mean values of your genes and use ebayes to shrink the variance\n#a t-test will then be done to get you the DEGs and a volcano plot to visualize \n\n#filtering of genes, removing all control probes and seeing what is filtered \ncon <- db(pd.hugene.2.0.st)\n\nprobes.control <- dbGetQuery(con, \"select fsetid from featureSet where\n                             type in ('5','6','7','8','9','10','11','12','13','14','15','16','17');\")[,1]\n\nnormData.filtered <- nsFilter(normData, require.entrez=FALSE, remove.dupEntrez=FALSE, feature.exclude = probes.control)\n#checking what was filtered out\n#normData.filtered$filter.log                    \n\n#Creating a design matrix based on the experiment and then a linear model for estimating mean expression values \n#bayes for shrinking the ste and getting DEGS\ngroup <- factor(c((rep.int(0,13)),rep.int(1,14),rep.int(2,14)\n                  ,rep.int(3,14),rep.int(4,14)))\n\ndesign <- model.matrix(~ 0 + group)\ncolnames(design) <- c(\"Intercept\",\"T1\",\"T2\",\"T3\", \"T4\")\n#contrast matrix \ncontrast <- makeContrasts( \"Intercept-T1\",\"Intercept-T2\",\"Intercept-T3\",\"Intercept-T4\"\n                           ,\"T1-T2\",\"T1-T3\",\"T1-T4\",\n                            \"T2-T3\",\"T2-T4\",\"T3-T4\", levels= design )\n\nnormfit <-eBayes( contrasts.fit( lmFit(normData.filtered$eset, design), contrast) )\n\n#getting the list of probes\nprobeset.InterceptT1 <-topTable(normfit,number=100000,coef = \"Intercept-T1\", adjust=\"BH\", lfc=1,sort.by =\"A\")\n        \nprobeset.InterceptT2 <-topTable(normfit,number=100000,coef = \"Intercept-T2\", adjust=\"BH\", lfc=1,sort.by =\"A\")\n\nprobeset.InterceptT3 <-topTable(normfit,number=100000,coef = \"Intercept-T3\", adjust=\"BH\", lfc=1,sort.by =\"A\")\n\nprobeset.InterceptT4 <-topTable(normfit,number=100000,coef = \"Intercept-T4\", adjust=\"BH\", lfc=1,sort.by =\"A\")\n\nprobeset.T1T2 <-topTable(normfit,number=100000,coef = \"T1-T2\", adjust=\"BH\", lfc=1,sort.by =\"A\")\n\nprobeset.T1T3 <-topTable(normfit,number=100000,coef = \"T1-T3\", adjust=\"BH\", lfc=1,sort.by =\"A\")\n\nprobeset.T1T4 <-topTable(normfit,number=100000,coef = \"T1-T4\", adjust=\"BH\", lfc=1,sort.by =\"A\")\n\nprobeset.T2T3 <-topTable(normfit,number=100000,coef = \"T2-T3\", adjust=\"BH\", lfc=1,sort.by =\"A\")\n\nprobeset.T2T4 <-topTable(normfit,number=100000,coef = \"T2-T4\", adjust=\"BH\", lfc=1,sort.by =\"A\")\n\nprobeset.T3T4 <-topTable(normfit,number=100000,coef = \"T3-T4\", adjust=\"BH\", lfc=1,sort.by =\"A\")\n\n#Adding gene symbol to dataset \n#Symbol <- getSYMBOL(rownames(probeset.InterceptT2), \"hugene20sttranscriptcluster.db\")\n\n\n#results <- cbind(probeset.list, Symbol)\n\n#writing results to a tab delimated text file\n#write.table(results,file=\"DEGS_ALL_CONTRAST.txt\",sep= \"\\t\" )\n\nwrite.table(probeset.InterceptT2, file=\"DEG_InterceptT2\", sep = \"\\t\")\n\n#visualizing genes with highest LFC and probably \nvolcanoplot(normfit,highlight=10, coef=2)\n",
    "created" : 1455183618863.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2956128420",
    "id" : "FA512C12",
    "lastKnownWriteTime" : 1455185807,
    "path" : "~/GitHub/Thesis-Project/Pipeline/Step_4_Genefiltering_Fitting_Model_Results.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}