{
    "contents" : "#This script will remove genes with low variance as well as the affy control probes\n#Then it will fit a linear models to determine the mean values of your genes and use ebayes to shrink the variance\n#a t-test will then be done to get you the DEGs and a volcano plot to visualize \n\n#filtering of genes, removing all control probes and seeing what is filtered \ncon <- db(pd.hugene.2.0.st)\n\nprobes.control <- dbGetQuery(con, \"select fsetid from featureSet where\n                             type in ('3', '5','6','7','8','9','10','11','12','13','14','15','16','17');\")[,1]\n\nnormData.filtered <- nsFilter(normData, require.entrez=FALSE, remove.dupEntrez=FALSE, feature.exclude = probes.control)\n#normData.filtered$filter.log                    \n\n#Creating a design matrix based on the experiment and then a linear model for estimating mean expression values \n#bayes for shrinking the ste and getting DEGS\ngroup <- factor(c((rep.int(0,13)),rep.int(1,14),rep.int(2,14)\n                  ,rep.int(3,14),rep.int(4,14)))\n\ndesign <- model.matrix(~ 0 + group)\ncolnames(design) <- c(\"I\",\"T1\",\"T2\",\"T3\", \"T4\")\n#contrast matrix \ncontrast <- makeContrasts( \"I-T1\",\"T1-T2\",\"T2-T3\",\"T3-T4\",\n                           levels= design )\n\nnormfit <-eBayes( contrasts.fit( lmFit(normData.filtered$eset, design), contrast) )\n\n#getting the list of probes\nprobeset.list <-topTable(normfit,number=100000, adjust=\"BH\", lfc=1)\n\n\n#Adding gene symbol to dataset \n#Symbol <- getSYMBOL(rownames(probeset.list), \"hugene20sttranscriptcluster.db\")\n#results <- cbind(probeset.list, Symbol)\n\n#writing results to a tab delimated text file\nwrite.table(results,file=\"DEGS_ALL_CONTRAST.txt\",sep= \"\\t\" )\n\n#visualizing genes with highest LFC and probably \nvolcanoplot(normfit,highlight=10, coef=2)\n",
    "created" : 1455205686662.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1745446502",
    "id" : "74B0D7CE",
    "lastKnownWriteTime" : 1455206122,
    "path" : "~/GitHub/Thesis-Project/Pipeline/Step_4_Genefiltering_Fitting_Model_Results.R",
    "project_path" : "Pipeline/Step_4_Genefiltering_Fitting_Model_Results.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}